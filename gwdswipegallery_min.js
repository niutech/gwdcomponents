(function(){"use strict";var g=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},l=function(a){if(g(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&g(a))return a;return null},p=function(a,b,c){a=parseInt(a.getAttribute(b),10);isNaN(a)&&(a=c);return a},q=function(a,b,c){a=parseFloat(a.getAttribute(b));isFinite(a)||(a=c);return a},r=function(a,b,c,d){d=d||b;a.hasAttribute(b)?(a=a.getAttribute(b),c.setAttribute(d,a)):c.removeAttribute(d)};var t=function(a,b){return setInterval(a,b)};var u=["-ms-","-moz-","-webkit-",""],v=function(a,b,c){for(var d,e,f=0;f<u.length;++f)d=u[f]+b,e=""+c,a.style.setProperty(d,e)};var w=function(a,b,c){var d;c?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c)):(d=document.createEvent("Event"),d.initEvent(a,!0,!0));b.dispatchEvent(d);return d},x=function(a,b){var c=function(d){a.removeEventListener("attached",c);b(d)};a.addEventListener("attached",c)};var y=function(a){a=a.trim();return window.Enabler?Enabler.getUrl(a):a};var z=function(a){var b=document.createElement("img","gwd-image");b.setAttribute("source",a);return b},A=function(a){var b=[];if(a){a=a.split(",");for(var c=0;c<a.length;++c)b.push(z(y(a[c])))}return b},B=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];"img"==e.tagName.toLowerCase()&&"gwd-image"==e.getAttribute("is")&&(null!=b?e.setAttribute("scaling",b):e.removeAttribute("scaling"))}},C=function(a,b){for(var c=b.length,d=b.splice(0,c),e,f=0;f<c;f++)e=d[f],"frameshown"==e?w(e,a,{id:a.currentIndex}):
w(e,a)};document.registerElement&&document.registerElement("gwd-swipegallery",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.v=!1;this.e=null;this.f=[];this.b=null;this.K=this.hasAttribute("images");this.k=0;var a=document.createElement("gwd-gesture");a.className="gesture";this.g=a;this.I=this.onTrack_.bind(this);this.H=this.onTrackEnd_.bind(this);this.G=this.onTap_.bind(this);this.J=this.onFramesLoad_.bind(this);this.w=w.bind(null,"firstinteraction",this);this.F=!1;
this.s=[];this.i=C.bind(null,this,this.s);this.C=this.B=this.r=0;this.j=null;this.a=0;this.q=1;this.t=[];this.u=0;this.d=1;this.L=.7;this.l=0;this.m=!1;this.n=this.A=0;this.c=null;this.D=[];this.o=this.p=-1},enumerable:!0},attachedCallback:{value:function(){this.g.addEventListener("track",this.I,!1);this.g.addEventListener("trackend",this.H,!1);this.g.addEventListener("tap",this.G,!1);this.addEventListener("transitionend",this.i,!1);this.addEventListener("webkitTransitionEnd",this.i,!1);l(this)||
"function"!=typeof this.gwdLoad||("function"==typeof this.gwdIsLoaded?this.gwdIsLoaded()||this.gwdLoad():this.gwdLoad())},enumerable:!0},detachedCallback:{value:function(){this.g.removeEventListener("track",this.I,!1);this.g.removeEventListener("trackend",this.H,!1);this.g.removeEventListener("tap",this.G,!1);this.removeEventListener("transitionend",this.i);this.removeEventListener("webkitTransitionEnd",this.i)},enumerable:!0},attributeChangedCallback:{value:function(a){switch(a){case "images":this.f=
A(this.getAttribute("images"));this.loadFrames_();this.styleAndStart_();break;case "scaling":B(this.f,this.getAttribute("scaling"));break;case "has-navigation":case "navigation-highlight":case "navigation-thumbnails":this.updateNavigationElement_();this.styleAndStart_();break;case "frame-snap-interval":case "transition-duration":case "exit-urls":this.updateSettings_();break;case "frame-width":case "frame-height":case "num-frames-to-display":this.updateSettings_();this.styleAndStart_();break;case "offset":case "start-frame":case "swipe-threshold-ratio":case "swipe-committed-threshold-ratio":this.styleAndStart_()}},
enumerable:!0},updateSettings_:{value:function(){var a=p(this,"num-frames-to-display",1),b=p(this,"frame-snap-interval",1),c=p(this,"transition-duration",600),d=p(this,"frame-width",-1),e=p(this,"frame-height",-1),f;f=this.hasAttribute("exit-urls")?this.getAttribute("exit-urls"):"";-1!=d?a=-1:0<a&&b>a&&(b=a);f=f.split(/,/g);this.h=a;this.d=b;this.r=c;this.D=f;this.p=d;this.o=e}},styleAndStart_:{value:function(){var a=this.clientWidth,b=this.clientHeight;this.c&&(b-=36);var c=p(this,"offset",0),d=
q(this,"swipe-threshold-ratio",.1),e=q(this,"swipe-committed-threshold-ratio",.5),f=-1==this.p?a:this.p,h=-1==this.o?b:this.o,k=1;0<this.h&&(f=(a-(this.h-1)*c)/this.h,k=1+Math.ceil(this.h/2-1));var k=p(this,"start-frame",k),m=f+c,n=1+2*Math.floor((a-f)/(2*m));if(1>n||!isFinite(n))n=1;a=(a-f)/2;b=(b-h)/2;0<this.h&&0==this.h%2&&(a-=(f+c)/2,n+=1);this.N=f;this.M=h;this.A=a;this.n=b;this.q=n;this.l=m;this.B=f*d;this.C=f*e;for(e=c=0;e<this.a;e++)d=this.f[e].style,d.left=c+"px",d.top=b+"px",d.width=f+"px",
d.height=h+"px",c+=m;this.k=0;this.e&&(this.animate_(0,0),this.e.style.left=a+"px");this.b=null;this.goToFrame(k,"none")},enumerable:!1},gwdIsLoaded:{value:function(){return this.v},enumerable:!0},gwdLoad:{value:function(){if(!this.v&&!this.e){var a;if(this.K)a=A(this.getAttribute("images"));else{a=this.childNodes;for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];e.nodeType==Node.ELEMENT_NODE&&b.push(e)}a=b}this.f=a;this.loadFrames_()}},enumerable:!0},goToFrame:{value:function(a,b){if(0!=this.a){a>
this.a?a=this.a:1>a&&(a=1);var c=a-1,c=c-c%this.d,c=c+Math.floor((this.d-1)/2);c>=this.a&&(c=this.a-1);var d=this.b;this.b=c;c=-this.l*this.b;this.animate_("none"!=b?this.r:0,c);this.k=c;this.markViewedFrames_();d!=this.b&&(this.maybeActivateFrame_(this.b+1),this.s.push("frameshown"));this.F||this.i()}},enumerable:!0},markViewedFrames_:{value:function(){if(this.u)for(var a=Math.floor((this.q-1)/2),b=0;b<this.q;b++){var c=this.b-a+b;if(!(0>c||c>=this.a||this.t[c]||(this.t[c]=!0,--this.u))){this.s.push("allframesviewed");
break}}}},animate_:{value:function(a,b){this.F=0<a;v(this.e,"transition","all "+a+"ms");v(this.e,"transform","translate3d("+b+"px,0,0)")},enumerable:!1},loadFrames_:{value:function(){for(;this.firstChild;)this.removeChild(this.firstChild);this.c=null;this.e&&this.e.removeEventListener("pageload",this.J,!1);for(var a=this.f,b=document.createElement("div","gwd-page"),c,d=0;d<a.length;++d)c=a[d],v(c,"user-select","none"),c.classList.add("frame"),b.appendChild(c);x(b,b.gwdLoad.bind(b));this.e=b;b.className=
"container";this.e.addEventListener("pageload",this.J,!1);B(this.f,this.getAttribute("scaling"));this.a=this.f.length;this.appendChild(b);this.appendChild(this.g)},enumerable:!1},onFramesLoad_:{value:function(a){a.target===this.e&&(this.v=!0,this.u=this.a,this.t=[],this.updateSettings_(),this.updateNavigationElement_(),this.styleAndStart_(),w("allframesloaded",this),this.hasAttribute("autoplay")&&(a=parseInt(this.getAttribute("autoplay-duration"),10)||3E3,setTimeout(this.rotateOnce.bind(this,a),0)),
w("ready",this))},enumerable:!1},rotateOnce:{value:function(a,b){if(this.a&&!this.j){for(var c=a||this.r,d=b||"forwards",e=Math.ceil(this.a/this.d),f=Math.floor(this.b/this.d),h=[],k=1;k<e;k++)h.push((e+("forwards"==d?f+k:f-k))%e*this.d);h.push(this.b);var m=0;this.j=t(function(){this.goToFrame(h[m++]+1);m>=h.length&&this.stopRotation_()}.bind(this),c/h.length)}},enumerable:!0},currentIndex:{get:function(){return 0<this.a?this.b+1:void 0},enumerable:!0},getFrame:{value:function(a){return this.f[a-
1]},enumerable:!0},goForwards:{value:function(a){null!=this.b&&this.goToFrame(this.b+1+this.d,a||"slide")},enumerable:!0},goBackwards:{value:function(a){null!=this.b&&this.goToFrame(this.b+1-this.d,a||"slide")},enumerable:!0},stopRotation_:{value:function(){this.j&&(clearInterval(this.j),this.j=null)},enumerable:!1},indicateCurrentSwipe_:{value:function(a){if(0<a&&0===this.b||0>a&&this.b===this.a-1)a-=a*this.L;this.animate_(0,this.k+a)}},completeCommittedMove_:{value:function(a){var b=this.a;if(b){var c=
this.b;a=this.getNewFrameIndex_(a);this.goToFrame(a+1);c!=a&&(0==a?w("reachleftend",this):a==b-1&&w("reachrightend",this))}}},updateNavigationElement_:{value:function(){var a=this.hasAttribute("has-navigation"),b=!!this.c;a&&!b?(a=this.id||this.getAttribute("data-gwd-grp-id"),this.c=document.createElement("gwd-gallerynavigation"),this.c.setAttribute("for",a),this.classList.add("has-navigation"),this.appendChild(this.c)):!a&&b&&(this.classList.remove("has-navigation"),this.removeChild(this.c),this.c=
null);this.c&&(r(this,"navigation-highlight",this.c,"highlight"),r(this,"navigation-thumbnails",this.c,"use-thumbnails"))}},getNewFrameIndex_:{value:function(a){var b=this.b;Math.abs(a)>this.B&&(b=0>a?b+this.d:b-this.d);0>b?b=0:b>=this.a&&(b=this.a-1);return b}},maybeActivateFrame_:{value:function(a){this.O!=a&&(this.O=a,w("frameactivated",this,{id:a||this.currentIndex}))}},onTrack_:{value:function(a){this.w&&(this.w(),this.w=null);this.m||(this.stopRotation_(),a=a.dx,this.maybeActivateFrame_(this.getNewFrameIndex_(a)+
1),Math.abs(a)>this.C?(this.completeCommittedMove_(a),this.m=!0):this.indicateCurrentSwipe_(a))},enumerable:!1},onTrackEnd_:{value:function(a){this.m?this.m=!1:this.completeCommittedMove_(a.dx)},enumerable:!1},onTap_:{value:function(a){this.stopRotation_();var b=this.getBoundingClientRect(),c=a.clientX-b.left;a=a.clientY-b.top;a<this.n||a>this.n+this.M||(a=c-this.k-this.A,c=Math.floor(a/this.l),a%=this.l,0>c||c>=this.a||a>this.N||((a=this.D[c])&&!w("frameexit",this,{url:a}).detail.handled&&window.open(a),
w("frametap",this,{id:c+1})))},enumerable:!1},frameSnapInterval:{get:function(){return this.d}},frameCount:{get:function(){return this.a}}})});})()
